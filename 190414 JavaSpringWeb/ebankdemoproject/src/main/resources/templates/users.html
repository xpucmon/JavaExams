<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <th:block th:include="~{fragments/head}"></th:block>
    <script th:src="@{/js/show.js}"></script>
</head>
<body>
<div class="container-fluid">
    <header>
        <th:block th:include="~{fragments/navbar}"></th:block>
    </header>

    <main>
        <div class="container mt-4">
            <table class="table table-hover mt-4" id="allUsers">
                <thead>
                <tr class="font-weight-bold">
                    <th scope="col">#</th>
                    <th scope="col">Username</th>
                    <th scope="col">Email</th>
                    <th scope="col">Current Role</th>
                    <th scope="col">Set New Role</th>
                    <th scope="col"></th>
                    <th scope="col"></th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="user, index : ${users}">
                    <th scope="row" th:text="${index.count}"></th>
                    <td th:text="${user.username}"></td>
                    <td th:text="${user.email}"></td>
                    <td>
                        <ul>
                            <th:block th:if="${#lists.contains(user.getAuthorities(), roleAdmin)}">
                                <li th:text="${roleAdmin}"></li>
                            </th:block>
                            <th:block th:if="${!#lists.contains(user.getAuthorities(), roleAdmin) &&
                                                #lists.contains(user.getAuthorities(), roleEmployee)}">
                                <li th:text="${roleEmployee}"></li>
                            </th:block>
                            <th:block th:if="${!#lists.contains(user.getAuthorities(), roleEmployee)}">
                                <li th:text="${roleUser}"></li>
                            </th:block>
                        </ul>
                    </td>
                    <td th:if="${!#lists.contains(user.getAuthorities(), roleRoot)}">
                            <th:block th:if="${#lists.contains(user.getAuthorities(), roleAdmin)}">
                                <a class="btn btn-info" th:text="'Set to User'"
                                   th:href="@{/users/rolechange/user/{id}(id=${user.getId()})}"></a>
                                <a class="btn btn-info mr-1" th:text="'Set to Employee'"
                                       th:href="@{/users/rolechange/employee/{id}(id=${user.getId()})}"></a>
                            </th:block>
                            <th:block th:if="${#lists.contains(user.getAuthorities(), roleEmployee) &&
                                                !#lists.contains(user.getAuthorities(), roleAdmin)}">
                                <a class="btn btn-info" th:text="'Set to User'"
                                   th:href="@{/users/rolechange/user/{id}(id=${user.getId()})}"></a>
                                <a class="btn btn-info mr-1" th:text="'Set to Admin'"
                                       th:href="@{/users/rolechange/admin/{id}(id=${user.getId()})}"></a>
                            </th:block>
                            <th:block th:if="${#lists.contains(user.getAuthorities(), roleUser) &&
                                                !#lists.contains(user.getAuthorities(), roleEmployee)}">
                                <a class="btn btn-info" th:text="'Set to Employee'"
                                   th:href="@{/users/rolechange/employee/{id}(id=${user.getId()})}"></a>
                                <a class="btn btn-info mr-1" th:text="'Set to Admin'"
                                       th:href="@{/users/rolechange/admin/{id}(id=${user.getId()})}"></a>
                            </th:block>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
    </main>
</div>
</body>
</html>